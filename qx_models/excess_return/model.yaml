model:
  id: excess_return
  version: 1.0.0
  featureset_id: ohlcv_v1+rf_v1
  description: |
    Calculate excess returns from OHLCV price data over various frequencies.
    
    Return Calculation:
    - Resamples OHLCV data to specified frequency (weekly, monthly, quarterly, yearly)
    - Calculates simple returns: (close_t - close_t-1) / close_t-1
    - Optionally subtracts risk-free rate to get excess returns
    
    Output:
    - DataFrame with date, symbol, return, frequency columns
    - Can be used for performance analysis, factor models, portfolio construction

io:
  inputs:
    # Input 1: Price data (curated) - for returns calculation
    - name: equity_prices
      required: true
      type:
        domain: market-data
        asset_class: equity
        subdomain: bars
        region: US
        frequency: monthly
      description: "Monthly OHLCV price data (will be resampled to target frequency)"

    # Input 2: Risk-free rate (curated) - optional for excess returns
    - name: risk_free
      required: false
      type:
        domain: reference-rates
        asset_class: fixed-income
        subdomain: yield-curves
        region: US
        frequency: monthly
      description: "Monthly risk-free rates (will be resampled to target frequency for excess returns)"

  output:
    type:
      domain: derived-metrics
      asset_class: equity
      subdomain: factors
      region: null
      frequency: null
    description: |
      Returns dataset with columns: date, symbol, return, frequency
      
      - date: Period end date
      - symbol: Ticker symbol
      - return: Simple return or excess return (if risk_free provided)
      - frequency: Frequency of returns (weekly, monthly, quarterly, yearly)

parameters:
  frequency:
    type: enum
    default: "monthly"
    allowed: ["weekly", "monthly", "quarterly", "yearly"]
    description: "Return frequency (weekly, monthly, quarterly, yearly)"

  return_type:
    type: enum
    default: "simple"
    allowed: ["simple", "log"]
    description: "Return calculation method (simple or log)"

  min_periods:
    type: int
    default: 1
    min: 1
    max: 100
    description: "Minimum number of observations required for return calculation"

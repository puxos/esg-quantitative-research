# S&P 500 Interval Membership Schema
# Interval-based membership tracking (ticker, start_date, end_date)

dataset:
  domain: membership
  asset_class: null
  subdomain: intervals
  region: null
  frequency: null

contract:
  schema_version: schema_v1

  columns:
    - name: ticker
      type: string
      description: Stock ticker symbol
      required: true
      filterable: true
      filter_type: in

    - name: start_date
      type: date
      description: Membership start date (inclusive)
      required: true
      filterable: true
      filter_type: range

    - name: end_date
      type: date
      description: Membership end date (inclusive)
      required: true
      filterable: true
      filter_type: range

  partition_keys:
    - universe
    - mode

  filters:
    ticker_list:
      columns: [ticker]
      type: in
      description: Filter to specific tickers
      example: ["AAPL", "MSFT", "GOOGL"]

    date_overlap:
      columns: [start_date, end_date]
      type: custom
      description: Filter intervals overlapping with date range
      example: ["2020-01-01", "2020-12-31"]

  path_template: data/curated/membership/universe={universe}/mode={mode}

parameters: {}

metadata:
  source: Synthesized from daily membership data
  description: |
    Interval representation of S&P 500 membership.
    One row per (ticker, start_date, end_date) run.

  dependencies:
    - sp500_membership (daily)

  notes: |
    Used for:
      - Efficient membership queries
      - Storage optimization (fewer rows)
      - Membership duration analysis

    Typical usage:
      - universe=sp500
      - mode=intervals

    Synthesized by detecting runs of consecutive presence in daily data.
